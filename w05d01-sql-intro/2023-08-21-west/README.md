# SQL Intro

## Today's menu

- What is a database
- Why should we use it
- Writing SQL

- Creating databases
- Creating tables
- Inserting data
- Searching through the data

## What is a database

- Organized collection of persistent data
- Information being written to be used at a later time
- Third tier of the web development architecture (Client - Application - Data)

### Database Management System (DBMS)

- Software designed to manage data in a database
- Manipulates the data, the data format, file structure.
- Defines rules to validate and manipulate this data
- Uses a query language

## Why should we use a DBMS ?

Instead of storing values in memory, it's preferable to use a database management system for multiple reasons.

- It's persistent, in opposition to in-memory storage
- It's optimized to handle a lot of transactions, unlike storing our data in a JSON file
- It's cross-platform, so you could have a JS client and a Python client interacting with the same DBMS
- Most DBMS support the [ACID properties](https://en.wikipedia.org/wiki/ACID) to make our data resilient against power failures/errors

### ACID properties
- DBMS that support **ACID** guarantees data validity despite power failures, errors, etc.
- **A**tomicity - The database makes each operation into a "unit" (often called a transaction), and the operation either succeeds 100% or fails completely. It is therefore impossible to have a row with half-filled columns.
- **C**onsistency - We can define which data types and values are valid for each column so we guarantee the table is highly structured
- **I**solation - Guarantees that concurrent transactions that affects the same row still happen one at a time, and that validity is checked each time (If you only have $100 in your bank and try to withdraw $100 at 2 ATM machines at the same time, only one will go through)
- **D**urability - Once committed, the data is stored on a persistent disk

#### Popular DBMS today

- SQLite (free software for all)
- MySQL (free software for non-commercial)
- PostgreSQL (free software for all)
- MariaDB (free software for all)
- Microsoft SQL Server (paid)
- Oracle (paid)


### Types of Databases

- Relational databases
  - MySQL, Postgresql, SQLite
- Document databases (JSON like format)
  - MongoDB
- Key-value stores (like Javascript objects)
  - Redis
- Column stores
  - Cassandran
  - HBase
- Graph databases
- Real-Time Database
  - Firebase

## Relational Databases

- Tables (data stored in rows and columns)
- There is a relationship between the tables
- Generally there is no repeated information across different tables (denormalization)


## SQL or Structured Query Language

- Developed by IBM in the early 70s
- Initially called SEQUEL (Structured English Query Language)

- Declarative language (vs imperative)
- We state only what we need
- We do not worry about how to get it

### Data Definition Language (DDL)

- Creating a database (createdb name)
- Deleting a database (dropdb name)
- Creating, modifying, of deleteing tables

[Create Tables](./db/1_schema.sql)

### Data Manipulation Language (DML)

- INSERT
- UPDATE
- DELETE
- SELECT

[Seeds](./db/2_seeds.sql)

## Write SELECT statements

- Tables have an id column marked as a PK, this is our "Primary Key"
- Primary keys are unique identifiers which identifies each row
- We are using an auto increment id generated by postgres
- The Foreign Key (FK) is going to contain the id value of the trainers table


### SELECT STATEMENT

Full Syntax of an SQL SELECT Query

```sql
SELECT column list, function(), function(), ...
FROM table1
INNER JOIN table2
ON table1.col1 = table2.col2
WHERE criteria for row selection
[AND criteria for row selection]
[OR criteria for row selection]
GROUP BY column list
HAVING criteria for function results
ORDER BY column list;
```

#### BASIC SELECT QUERY

- The SELECT statement is specifying the columns of the tables should be part of the output
- `*` all columns or specify each column names individually

`SELECT * FROM pokemon;`

`SELECT name FROM pokemon;`

`SELECT * from trainers;`

`SELECT name, biography from trainers;`

- The `WHERE` is filtering out the rows of the result set

```sql
SELECT *
FROM pokemon
WHERE type = 'Water';
```

- We can use `ORDER BY` to sort the result set

```sql
SELECT *
FROM pokemon
WHERE type = 'Water'
ORDER_BY cuteness_rating DESC;
```

- Aggregate functions

- We can use aggregate functions like `COUNT`, `SUM`, `AVG`, `MIN`,`MAX`

```sql
SELECT AVG(cuteness_rating), type
FROM pokemon
GROUP BY type;
```

- JOINS

- We use joins when we need the data of more than one table

- There are different types of joins

  - INNER JOIN (JOIN)
  - LEFT JOIN / RIGHT JOIN
  - FULL OUTER JOIN

```sql
SELECT *
FROM pokemon
INNER JOIN trainers
ON pokemon.trainer_id = trainers.id;
```

